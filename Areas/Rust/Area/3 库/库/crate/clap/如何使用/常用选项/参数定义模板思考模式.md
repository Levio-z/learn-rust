```rust
#[derive(Parser)]
#[command(version, about, long_about = None)]
struct Cli {

    /// Sets a custom config file
    #[arg(short, long, value_name = "FILE")]
    config: Option<PathBuf>,
    
	#[arg(num_args = 1..)]
	files: Vec<PathBuf>,

    /// Turn debugging information on
    #[arg(short, long, action = clap::ArgAction::Count)]
    debug: u8,
    
    #[arg(short, long)]
    write: bool,
    
    /// Optional name to operate on
    name: String,
	
	//⚠️ 可选位置参数：**只能出现在最后**
	/// Optional name to operate on
    name2: Option<String>,
    
    #[command(subcommand)]
    command: Option<Commands>,
}
```
### 基本思考模式
- [github模板代码](https://github.com/learn-rust-projects/rust-lab/blob/master/cli-lab/clap-lab/src/main.rs)
- [位置参数和命名参数](../研究/位置参数和命名参数.md)
- [参数匹配顺序](参数匹配顺序.md)
- 命名参数具体配置解析[args具体配置解析](../子命令/args具体配置解析.md)
- 位置参数：
	- 核心直接必填T
	- 非必填加Option
	- `Vec<T>`：默认非必填
	- bool：不要设置成bool，**不好的设计**
		- [bool 非要设置成位置参数这么设计](../研究/bool%20非要设置成位置参数这么设计.md)
- 具名参数：`[arg(long / short)]`
	- （默认都是可选的）可选加Option 需要 --名字
		- bool必须设置成具名参数,而且不是必填，传来值就是true，可以不传
### 参数的显示和填写顺序

```
Usage: clap-lab [OPTIONS] --debug <DEBUG> <PORT> [NAME] [COMMAND]
```

| 部分                | 类型       | 位置             | 必填性               |
| ----------------- | -------- | -------------- | ----------------- |
| `[OPTIONS]`       | 具名参数     | 可放任意位置         | 可选                |
| `--debug <DEBUG>` | 具名参数 + 值 | 必须跟在命令行中       | 必填（字段类型是非 Option） |
| `<PORT>`          | 位置参数     | 必须出现在该位置       | 必填                |
| `[NAME]`          | 位置参数     | 出现在 `<PORT>` 后 | 可选（Option）        |
| `[COMMAND]`       | 子命令      | 出现在最后          | 可选                |

### 具体类型
1.  **位置参数**：`name: Option<String>`
	-   可选的位置参数。
	-   如果用户提供了，例如 `my_cli Alice`，`name` 就会是 `Some("Alice")`。
2.  **具名参数：value_name = "FILE"**：
- `config: Option<PathBuf>`
	- 通过 `-c FILE` 或 `--config FILE` 提供。
	- value_name = "FILE"
		- 用于指定该选项所接受的值在帮助信息中的显示名称。
 3. **可选bool参数**：write: bool,
```rust
#[arg(short, long)]
write: bool,
```
- 不可选不加arg
4.  **统计参数**：`debug: u8`
-   带计数的 flag，例如：
		```bash
		my_cli -d       # debug = 1
		my_cli -dd      # debug = 2
		my_cli -ddd     # debug = 3
		```
	-   `ArgAction::Count` 是 clap v4 的新语法，用于统计 flag 出现次数。
5.  `command: Option<Commands>`
	-   可选子命令，支持类似 Git 风格的多命令，例如 `my_cli test --list`。
	-   子命令结构在下面的 `Commands` 枚举中定义。
### 可选参数
**多个「可选」位置参数 = 默认歧义**

clap 的基本规则是：

- ✅ 必选位置参数：可以连续出现
    
- ⚠️ 可选位置参数：**只能出现在最后**
    
- ❌ 多个可选位置参数并列：不允许，除非引入边界