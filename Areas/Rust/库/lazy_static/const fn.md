åœ¨ Rust ä¸­ï¼Œ`const fn` è¡¨ç¤º **å¯ä»¥åœ¨ç¼–è¯‘æœŸæ‰§è¡Œçš„å‡½æ•°**ã€‚

> æ¢å¥è¯è¯´ï¼šä½ å¯ä»¥åœ¨ `const` æˆ– `static` ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¹¶ç›´æ¥è·å¾—ä¸€ä¸ª**å¸¸é‡ç»“æœ**ï¼Œè€Œä¸éœ€è¦è¿è¡Œæ—¶è®¡ç®—ã€‚

ç¤ºä¾‹ï¼šæ™®é€šå‡½æ•° vs `const fn`
```rust
fn square(x: i32) -> i32 {
    x * x
}

// âŒ é”™è¯¯ï¼šä¸èƒ½åœ¨ const ä¸­è°ƒç”¨æ™®é€šå‡½æ•°
const VAL: i32 = square(5);

```
æ”¹æˆ `const fn`ï¼š
```rust
const fn square(x: i32) -> i32 {
    x * x
}

const VAL: i32 = square(5);  // âœ… ç¼–è¯‘æœŸæ±‚å€¼ï¼ŒOK

```
### ä½¿ç”¨åœºæ™¯
#### 1. åˆå§‹åŒ– `const` æˆ– `static` å˜é‡
#### 2. æ”¯æŒæ³›å‹å¸¸é‡ï¼ˆconst genericsï¼‰
```rust
struct Buffer<const N: usize> {
    data: [u8; N],
}

const fn default_size() -> usize { 128 }

type DefaultBuf = Buffer<{ default_size() }>;

```
#### 3. ç¼–è¯‘æœŸæ„é€ å¤æ‚ç»“æ„ï¼ˆæ¯”å¦‚æŸ¥è¡¨ã€æ„é€  LUTã€å“ˆå¸Œç§å­ï¼‰
ç”±äºç¼–è¯‘å™¨å¿…é¡»ä¿è¯ç¼–è¯‘æœŸè¿è¡Œçš„ä»£ç æ˜¯ç¡®å®šæ€§ã€æ— å‰¯ä½œç”¨çš„ï¼Œ`const fn` çš„èƒ½åŠ›æ˜¯é€æ­¥æ”¾å¼€çš„ã€‚ç›®å‰æ”¯æŒï¼š
- è¿ç®—ã€æ¡ä»¶åˆ†æ”¯ã€å¾ªç¯ï¼ˆ`while` / `for`ï¼‰
- æšä¸¾åŒ¹é… (`match`)
- `&mut` å¯å˜å¼•ç”¨ï¼ˆå¸¦é™åˆ¶ï¼‰
- æ³›å‹å‡½æ•°ï¼ˆå¯å¸¦ `const` å‚æ•°ï¼‰
- `Result` / `Option` ç­‰æ§åˆ¶æµ
- **ä» Rust 1.61 èµ·ï¼šæ”¯æŒ `if let`ã€`while let` ç­‰æ¨¡å¼åŒ¹é…**
ä¸å…è®¸ï¼ˆæˆ–å—é™ï¼‰ï¼š
- `unsafe` å—ï¼ˆéƒ¨åˆ†æ”¯æŒï¼Œéœ€æ ‡è®°ï¼‰
- åŠ¨æ€åˆ†é…ï¼ˆå †ä¸Šåˆ†é…ï¼‰
- IOã€çº¿ç¨‹ã€FFI ç­‰è¿è¡Œæ—¶ä»£ç 
- ä¸€ä¸ªå…¸å‹ä¾‹å­ï¼š`const fn` æ„é€ é™æ€æŸ¥æ‰¾è¡¨
```rust
const fn fib(n: usize) -> usize {
    if n == 0 { 0 } else if n == 1 { 1 } else { fib(n-1) + fib(n-2) }
}

const FIB_TABLE: [usize; 10] = {
    let mut arr = [0; 10];
    let mut i = 0;
    while i < 10 {
        arr[i] = fib(i);
        i += 1;
    }
    arr
};


```
ä½ å¯ä»¥åœ¨ **ç¼–è¯‘æœŸ** æ„é€ è¿™ä¸ªæ•°ç»„ï¼Œ**0 è¿è¡Œæ—¶å¼€é”€**ã€‚
ğŸ”¬ å’Œ `const` / `static` çš„å…³ç³»

|æœ¯è¯­|å«ä¹‰|
|---|---|
|`const`|å®šä¹‰ä¸€ä¸ªç¼–è¯‘æœŸæ±‚å€¼çš„å¸¸é‡ï¼ˆä¸å¯ä¿®æ”¹ã€æ— åœ°å€ï¼‰|
|`static`|å®šä¹‰ä¸€ä¸ªæœ‰ `'static` ç”Ÿå‘½å‘¨æœŸçš„å…¨å±€å˜é‡ï¼ˆå¯æœ‰åœ°å€ï¼‰|
|`const fn`|å¯ä»¥åœ¨ `const` æˆ– `static` ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨çš„å‡½æ•°|