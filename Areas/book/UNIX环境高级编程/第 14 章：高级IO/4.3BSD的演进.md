---
tags:
  - note
---
## 1. 核心观点  


## 2. 展开说明  
你提供的这段文字是对 Unix/Linux 系统中**非阻塞 I/O** 历史演变的另一个重要补充，侧重于 **4.3BSD** 系统的实现，并最终强调了 **$\text{POSIX.1}$ 标准的统一性**。

这段文字的核心要点可以总结为：

### 1. 4.3BSD 的早期机制 ($\text{FNDELAY}$ 和 $\text{EWOULDBLOCK}$)

- **标志：** 4.3BSD 使用 $\text{fcntl}$ 函数提供了 **$\text{FNDELAY}$** 标志来指定非阻塞模式。
    
- **语义区别（影响范围）**：
    
    - $\text{FNDELAY}$ 不仅影响当前的**文件表项**（File Table Entry），还会直接更改**设备**（终端或套接字）本身的非阻塞标志。
        
    - **后果**：这导致对该设备进行操作的**所有用户/进程**（即使它们使用不同的文件表项）都会受到非阻塞模式的影响。这是一种**全局性**的改变。
        
- **适用范围**：4.3BSD 的非阻塞 I/O **只对终端和套接字**起作用，对普通文件无效。
    
- **返回值：** 如果非阻塞操作不能立即完成，4.3BSD 返回 **$\text{EWOULDBLOCK}$** 错误。
    

### 2. 向 $\text{POSIX.1}$ 标准的演进和统一

- **现代 BSD 系统**：现今基于 BSD 的系统已经采纳了 $\text{POSIX.1}$ 标准。
    
- **标志统一**：它们现在支持并使用 $\text{POSIX.1}$ 的 **$\text{O\_NONBLOCK}$** 标志。
    
- **错误码统一**：它们将 $\text{EWOULDBLOCK}$ **定义为与 $\text{POSIX.1}$ 的 $\text{EAGAIN}$ 相同**（$\text{EAGAIN}$ 通常是标准 $\text{POSIX}$ 系统中的非阻塞错误）。
    
- **语义统一（文件表项）**：$\text{POSIX}$ 兼容的非阻塞语义是：文件状态标志的更改**只影响**使用同一**文件表项**的用户。它与通过其他文件表项对同一设备的访问无关。
    

### 总结

这段文字补充了 $\text{System V}$ 和 $\text{BSD}$ 两大 Unix 派系在早期实现非阻塞 I/O 时的差异，并强调了 $\text{POSIX.1}$ 标准最终如何**统一了**这两个派系的非阻塞 I/O 行为：

1. **统一标志：** 放弃 $\text{O\_NDELAY}$ / $\text{FNDELAY}$，采纳 $\text{O\_NONBLOCK}$。
    
2. **统一错误码：** $\text{EAGAIN}$ (或 $\text{EWOULDBLOCK}$ 与 $\text{EAGAIN}$ 相同) 代表“无数据可读，稍后重试”。
    
3. **统一作用范围：** $\text{O\_NONBLOCK}$ 的作用范围被限制在**当前的文件表项**，而不是影响整个设备。


## 3. 与其他卡片的关联  
- 前置卡片：
- 后续卡片：
- 相似主题：

## 4. 背景/出处  
- 来源：
- 引文/摘要：  
  - …  
  - …  

## 5. 应用/启发  
- 可以如何应用在工作、学习、生活中  
- 引发的思考与问题  

## 6. 待办/进一步探索  
 
  
