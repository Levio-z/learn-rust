| **命令**                 | **行为模式**        | **主要功能和工作原理**                                                                                               | **错误/返回值**                                                                               |
| ---------------------- | --------------- | ----------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------- |
| **$\text{F\_GETLK}$**  | **查询**          | **判断**由 `flockptr` 所描述的锁是否会被**现有的一把锁所排斥**（即阻塞）。                                                             | **存在冲突：** 现有锁的信息会**重写** `flockptr` 指向的信息。[5.2.2 现有锁重写信息](5.2.2%20现有锁重写信息.md)                           |
|                        |                 |                                                                                                             | **无冲突：** `flockptr` 中的 $\text{l\_type}$ 会被设置为 $\text{F\_UNLCK}$，其他信息保持不变。                |
| **$\text{F\_SETLK}$**  | **设置/释放锁（非阻塞）** | 用于**设置或清除** 由 `flockptr` 所描述的锁（$\text{l\_type}$ 为 $\text{F\_RDLCK}$、$\text{F\_WRLCK}$ 或 $\text{F\_UNLCK}$）。 | **冲突时：** 如果锁不能立即授予，`fcntl` 会立即出错返回，$\text{errno}$ 设置为 $\text{EACCES}$ 或 $\text{EAGAIN}$。 |
| **$\text{F\_SETLKW}$** | **设置锁（阻塞/等待）**  | 是 $\text{F\_SETLK}$ 的**阻塞版本**（$\text{W}$ 代表等待 $\text{wait}$）。用于请求读锁或写锁。                                     | **冲突时：** 调用进程会被置为**休眠**，直到请求的锁可用，或者休眠被信号中断。                                              |
