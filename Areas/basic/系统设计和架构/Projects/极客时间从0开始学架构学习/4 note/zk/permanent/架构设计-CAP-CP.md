---
tags:
  - permanent
---
## 1. 核心观点  

出现分区时，系统会优先保障数据一致性，限制不一致的节点提供服务，数据已更新且处于一致状态的节点可以提供服务。


## 2. 背景/出处  

## 3. 展开说明  
### CP - Consistency/Partition Tolerance

原因在于，CAP 里的一致性（C）是指分布式系统中所有节点的数据保持一致，而分区（P）是客观存在的网络故障。为了保证 CP，当 N1 和 N2 出现分区时，系统会优先保障数据一致性，限制不一致的节点（N2）提供服务（返回 Error），但数据已更新且处于一致状态的 N1，完全可以正常响应客户端的读写请求，不会被限制服务。

![](asserts/Pasted%20image%2020251219093425.png)

在这个符合 CP 模型的场景中，N1 节点是可以提供服务的。
 
### CP的最终的CA
在用户管理系统中选择 **CP（Consistency + Partition tolerance）**，意味着在发生网络分区后，系统优先保证**一致性**，允许牺牲**可用性**。  
当分区发生后，节点 1 与节点 2 之间通信中断：
- **节点 1** 仍可与一致性仲裁方（如 leader / quorum）形成有效一致性路径，因此可以继续处理注册请求并成功写入。
- **节点 2** 因无法确认写入是否会与节点 1 产生冲突，必须拒绝注册请求并返回 error。  
    这正是“不满足 A（Availability）”的体现：**系统对部分正常节点上的请求不可用**。

当分区恢复后，节点1读取日志中的记录，同步给节点2，当同步完成后，节点1和节点2就达到了同时满足CA的状态。

### 完美的CP方案也不存在
CAP理论是忽略延时的，而实际应用中延时是无法避免的。这一点就意味着完美的CP场景是不存在的，即使是几毫秒的数据复制延迟，在这几毫秒时间间隔内，系统是不符合CP要求的。**因此CAP中的CP方案，实际上也是实现了最终一致性，只是“一定时间”是指几毫秒而已。**
## 4. 与其他卡片的关联  
- 前置卡片：
- 后续卡片：
- 相似主题：

## 5. 应用/启发  
- 可以如何应用在工作、学习、生活中  
- 引发的思考与问题  

## 6. 待办/进一步探索  
 
  
