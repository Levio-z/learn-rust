---
tags:
  - permanent
---
## 1. 核心观点  

规则引擎（Rule Engine）是一类 **将业务逻辑从代码中分离出来，并以可配置规则驱动程序行为** 的系统。开发者不再以 if/else 写逻辑，而是通过 **规则（Rule）+ 条件（Condition）+ 动作（Action）** 来描述业务，由引擎负责解析与执行。

>不改代码，通过编辑规则即可改变系统行为。
## 2. 背景/出处  

## 3. 展开说明  

### 规则引擎：解决的问题

传统 if/else 会面临如下痛点：

- **组合爆炸**：多个条件 × 多种策略 = 无穷分支
    
- **需求变化频繁**：营销、风控、定价、推荐等每天都在改
    
- **业务人员无法参与**：逻辑写死在代码里
    
- **跨团队协作困难**：每次改规则都需要发布新版本
    
- **逻辑可视化差**：难阅读、难调试、难审计
    

规则引擎通过规则模型统一描述业务，实现“逻辑外置化”，降低复杂度。
### 规则引擎：核心组成

#### **规则（Rule）**

由条件 + 动作组成，形式为：
```

IF 条件成立 THEN 执行动作
```
#### **条件（Condition）**

判断规则是否触发，可由多个字段、阈值、逻辑表达式组合。

#### **动作（Action）**

规则执行后的行为，如：

- 设置折扣
    
- 标记风控等级
    
- 拒绝交易
    
- 调用外部服务
#### **推理引擎（Inference Engine）**

负责解析规则、匹配事实、决定执行顺序。经典算法为 **Rete**，擅长高性能多规则匹配。


#### **工作内存（Working Memory）**

存放事实（Fact）数据，例如：
```
用户年龄、会员等级、订单金额、设备风险评分
```
引擎从工作内存获取信息来匹配规则。

### 规则引擎：典型应用场景

#### **电商营销**

- 满减、折扣、积分、会员价、组合优惠
    
- 多规则叠加、不同活动优先级
    
- 频繁变更、可配置化需求极高
    

#### **金融风控 / 信审系统**

- 地理位置异常
    
- 设备指纹风险
    
- 用户行为模式
    
- 交易额度判断
    
- 多规则协同决策
    

#### **保险定价 / 报价系统**

- 年龄 × 车系 × 城市 × 历史赔付
    
- 条件组合巨大
    
- 需要业务侧可实时调整策略
    

#### **推荐规则 / 策略调度**

- 各种曝光、过滤、排序规则
    
- 年度、节日活动可快速切换

### 规则引擎 vs 传统 if/else

|特性|if/else|规则引擎|
|---|---|---|
|扩展性|差，分支增加很痛苦|强，添加规则即可|
|可读性|差|高|
|需求变更成本|高|低|
|业务人员可配置性|几乎没有|可视化规则维护|
|分支组合能力|非常差|天然支持规则组合|
|系统行为灵活性|固定|强，可动态加载|

规则引擎通常会更复杂，但可演化、可维护、可扩展。

### 规则引擎：执行流程示例

以支付风控为例：

**规则示例：**
```

规则1：IF 金额 > 5000 AND 地理位置异常 THEN 风控等级 = 高  
规则2：IF 连续失败次数 >= 3 THEN 锁定账户  
规则3：IF 新用户 AND 大额交易 AND 信用卡 THEN 风控等级 = 极高

```

**执行流程：**

1. 将“交易事实”写入工作内存
    
2. 引擎调度规则逐条匹配
    
3. 所有命中的规则依次执行
    
4. 输出最终决策（通过 / 拒绝 / 加验证）
    

系统行为通过规则变化，而非改代码。

### 规则引擎：优势与代价

#### **优势**

- 高度灵活
- 业务可配置
- 强可扩展性
- 强组合能力
- 适用于中大型系统的“变化管理”

#### **代价**

- 抽象成本高
- 调用链更复杂
- 对规则设计与工程能力要求高
- 难用于极简单的需求（小题大做）

核心理念与装饰者模式完全一致：

> **为了可扩展性和可演化性，你必须接受结构更复杂。**


## 4. 与其他卡片的关联  
- 前置卡片：
	- [架构设计-可扩展性-基本概念](架构设计-可扩展性-基本概念.md)
- 后续卡片：

- 相似主题：

## 5. 应用/启发  
- 可以如何应用在工作、学习、生活中  
- 引发的思考与问题  

## 6. 待办/进一步探索  
- [ ] 深入阅读 xxx  
- [ ] 验证这个观点的边界条件  
