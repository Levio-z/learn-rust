### 基本定义

QEMU（Quick EMUlator）是一个开源的虚拟化平台和系统仿真器，它既可以模拟整个硬件系统（系统级仿真），也可以模拟用户态进程（用户模式仿真）。在操作系统开发、嵌入式开发、架构移植等领域广泛使用。
操作系统开发
- 编写的内核将主要在 Qemu 模拟器上运行来检验其正确性。这样做主要是为了方便快捷，只需在命令行输入一行命令即可让内核跑起来。
- 可以使用软件 qemu-system-riscv64来模拟一台 64 位 RISC-V 架构的计算机，它包含CPU 、物理内存以及若干 I/O 外设。它的具体配置（比如 CPU 的核数或是物理内存的大小）均可由用户通过Qemu的执行参数选项来调整。
- 作为模拟器，在宿主机看来它只是一个用户程序，因此上面提到的资源都是它利用宿主机（即 Qemu 运行所在的平台，如 Linux/Windows/macOS）提供给它的资源模拟出来
- 在 Qemu 上模拟出来的某些硬件资源性能很高，甚至接近宿主机上原生资源的性能；而另一些硬件资源的模拟开销较大，从而导致Qemu模拟的整体硬件性能相对较慢。



### 核心能力
| 功能                      | 说明                                                 |
| --------------------------- | ------------------------------------------------------ |
| 系统级仿真（System Emulation） | 模拟整个计算机系统，包括 CPU、内存、磁盘、网络等，能启动完整 OS                |
| 用户级仿真（User Emulation）   | 模拟单个进程，适用于在不同架构上运行交叉编译程序（如 ARM 程序在 x86）            |
| 虚拟化（Acceleration）       | 利用硬件加速（如 KVM）提升仿真效率，实现接近原生性能的虚拟机运行                 |
| 支持多架构                   | 支持 x86, ARM, RISC-V, MIPS, PowerPC, SPARC 等多种指令集架构 |
| 多设备支持                   | 可模拟 UART、VirtIO、网卡、中断控制器、硬盘、显示器等多种硬件设备             |
### 常见场景
| 场景        | 示例                                          |
| --------- | ------------------------------------------- |
| 操作系统开发    | 在 QEMU 中运行自己写的内核，如 TeachingOS、rCore、MIT xv6 |
| 交叉架构测试    | 在 x86 主机上模拟运行 RISC-V、ARM 架构系统               |
| 嵌入式开发     | 模拟开发板（如 virt、raspi3）运行 Linux 或裸机程序          |
| 自动化 CI 测试 | 在 CI 中启动完整虚拟机运行集成测试                         |
| 教学实验平台    | 教授 OS/编译器课程时使用 QEMU 做 CPU+内存模拟环境            |
#### os开发
```
+--------------------+
| 你的 PC / 主机环境 |

+--------------------+
         |
         v
+--------------------+
|       QEMU         |   ← 模拟一台完整计算机
| (RISC-V, ARM, etc) |

+--------------------+
         |
         v
+--------------------+
|   你的操作系统内核  |   ← TeachingOS、rCore、xv6...
+--------------------+
```
##### 运行一个裸机 RISC-V 内核
```
qemu-system-riscv64 \
  -machine virt \
  -nographic \
  -bios rustsbi-qemu.bin \
  -kernel kernel.bin
```
说明：
- `-machine virt`：使用 QEMU 内置的 virt 虚拟开发板
- `-nographic`：关闭图形界面，使用串口输出
- `-bios`：引导固件，用于裸机程序（如 RustSBI）
- `-kernel`：你的内核二进制文件（通常为 ELF 格式）