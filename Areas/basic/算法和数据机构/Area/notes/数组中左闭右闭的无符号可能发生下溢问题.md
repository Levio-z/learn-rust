---
tags:
  - permanent
---
## 1. æ ¸å¿ƒè§‚ç‚¹  

å¯¹äºå·¦è¾¹ç•Œå’Œå³è¾¹ç•Œï¼Œåˆå§‹0ï¼Œn-1ï¼Œå¾ªç¯éå†æ‰€æœ‰å…ƒç´ ï¼Œå¦‚æœå¾ªç¯æ¡ä»¶æ—¶a<=béå†å…ƒç´ ,å¯èƒ½ä¼šé‡åˆ°æ— ç¬¦å·çš„ä¸‹æº¢é—®é¢˜ã€‚

åªæœ‰ä¸€ä¸ªæ•°1ï¼Œåˆå§‹start=end=0;
å¦‚æœè§¦å‘äº†end-1çš„åˆ†æ”¯ï¼Œæ— ç¬¦å·ç›¸å‡å‘ç”Ÿä¸‹æº¢
end = usize::Max

å¦‚ä½•è§£å†³ï¼Œä½¿ç”¨å·¦é—­å³å¼€çš„åŒºé—´ï¼Œbå§‹ç»ˆæ˜¯æ•°ç»„ä¸­è¢«æ’é™¤å…ƒç´ çš„ç´¢å¼•ï¼Œæ‰€ä»¥ä¸ä¼šå‘ç”Ÿä¸‹æº¢é—®é¢˜ã€‚

## 2. èƒŒæ™¯/å‡ºå¤„  
- æ¥æºï¼š
- å¼•æ–‡/æ‘˜è¦ï¼š  
  - â€¦  
  - â€¦  

## 3. å±•å¼€è¯´æ˜  
éå¸¸å¥½ï¼Œè¿™ä¸ªé—®é¢˜éå¸¸å…¸å‹ï¼Œæ¶‰åŠ **ç´¢å¼•è¶Šç•Œä¸æ— ç¬¦å·æ•´æ•° underflowï¼ˆä¸‹æº¢ï¼‰**ã€‚  
æˆ‘ä»¬æ¥é€è¡Œåˆ†æä½ çš„ `sorted_squares` å‡½æ•°ï¼Œé‡ç‚¹æ˜¯ç†è§£ä¸ºä»€ä¹ˆ `index 18446744073709551615` è¿™ä¸ªå·¨å¤§æ•°å­—ä¼šå‡ºç°ã€‚

---

### ä¸€ã€é”™è¯¯å¤ç°ä¸å®šä½

[977 æœ‰åºæ•°ç»„å¹³æ–¹æ’åº](../LeetCode/Done/977%20æœ‰åºæ•°ç»„å¹³æ–¹æ’åº.md)
é”™è¯¯æç¤ºï¼š

```
index out of bounds: the len is 1 but the index is 18446744073709551615
```

> ğŸ” `18446744073709551615` æ˜¯ `usize::MAX`ï¼Œå³ `2^64 - 1`ã€‚  
> è¿™æ„å‘³ç€æŸä¸ª `usize` å˜é‡ï¼ˆç´¢å¼•ï¼‰ä» 0 å‡å» 1ï¼Œäº§ç”Ÿäº† **ä¸‹æº¢**ã€‚

Rust ä¸­ `usize` æ˜¯æ— ç¬¦å·ç±»å‹ï¼Œ0 - 1 ä¸ä¼šå˜æˆ -1ï¼Œè€Œæ˜¯ç»•å›åˆ°æœ€å¤§å€¼ã€‚

---

### äºŒã€è§¦å‘æ¡ä»¶åˆ†æ

ä»£ç æ ¸å¿ƒé€»è¾‘ï¼š

```rust
while l <= r {
    if -nums[l] > nums[r] {
        ans[n-1] = nums[l] * nums[l];
        l += 1;
    } else {
        ans[n-1] = nums[r] * nums[r];
        r -= 1;
    }
    n -= 1;
}
```

å‡ºé—®é¢˜çš„æ˜¯ `ans[n-1]`ã€‚  
å‡è®¾æ•°ç»„é•¿åº¦æ˜¯ 1ï¼Œå³ `n = 1`ï¼š

#### ç¬¬ä¸€æ¬¡å¾ªç¯ï¼š

- `l = 0`, `r = 0`
    
- `ans[n-1] = ans[0]` âœ… åˆæ³•
    
- `n -= 1` â†’ `n = 0`
    
- `r -= 1` â†’ `r = usize::MAX` ï¼ˆå› ä¸º `r` æ˜¯æ— ç¬¦å·æ•°ï¼‰
    

#### ç¬¬äºŒæ¬¡å¾ªç¯åˆ¤æ–­ï¼š

`while l <= r` â†’ `0 <= usize::MAX` âœ… ä»ç„¶ä¸ºçœŸï¼

> å¾ªç¯ç»§ç»­æ‰§è¡Œï¼Œä½†ç°åœ¨ï¼š
> 
> - `n = 0`
>     
> - `ans[n-1] = ans[usize::MAX]` âŒ è¶Šç•Œ  
>     å¯¼è‡´ index out of boundsã€‚
>     

---

### ä¸‰ã€æ ¹æœ¬åŸå› 

#### 1. `r` ç±»å‹æ˜¯ `usize`

`r = n - 1` â†’ ç±»å‹ä¸º `usize`ï¼Œæ— ç¬¦å·æ•´æ•°ï¼Œä¸èƒ½è¡¨ç¤ºè´Ÿæ•°ã€‚  
å½“æ‰§è¡Œ `r -= 1` æ—¶ï¼Œè‹¥ `r == 0`ï¼Œç»“æœå˜æˆ `usize::MAX`ã€‚

#### 2. `while l <= r` åœ¨æ— ç¬¦å·ç±»å‹ä¸‹æ°¸è¿œä¸ä¼šâ€œè‡ªç„¶ç»“æŸâ€

å½“ `r` ä¸‹æº¢åå˜æˆä¸€ä¸ªè¶…å¤§æ­£æ•°ï¼ˆ`usize::MAX`ï¼‰ï¼Œ  
æ¡ä»¶ `l <= r` æ°¸è¿œä¸ºçœŸï¼Œäºæ˜¯æ­»å¾ªç¯ + è¶Šç•Œã€‚

---

### å››ã€è§£å†³æ–¹æ¡ˆ

#### âœ… æ–¹æ¡ˆ 1ï¼šä½¿ç”¨æœ‰ç¬¦å·ç±»å‹ `i32` / `isize` æ§åˆ¶ç´¢å¼•

```rust
pub fn sorted_squares(nums: Vec<i32>) -> Vec<i32> {
    let n = nums.len();
    let mut ans = vec![0; n];
    let (mut l, mut r) = (0_i32, (n - 1) as i32);
    let mut pos = (n - 1) as i32;

    while l <= r {
        if -nums[l as usize] > nums[r as usize] {
            ans[pos as usize] = nums[l as usize] * nums[l as usize];
            l += 1;
        } else {
            ans[pos as usize] = nums[r as usize] * nums[r as usize];
            r -= 1;
        }
        pos -= 1;
    }
    ans
}
```

#### âœ… æ–¹æ¡ˆ 2ï¼šä¿ç•™ `usize`ï¼Œä½†ç”¨ `for` å€’åºéå†

è¿™æ ·é¿å…æ‰‹åŠ¨é€’å‡ï¼š

```rust
pub fn sorted_squares(nums: Vec<i32>) -> Vec<i32> {
    let n = nums.len();
    let mut ans = vec![0; n];
    let (mut l, mut r) = (0, n - 1);

    for p in (0..n).rev() {
        if -nums[l] > nums[r] {
            ans[p] = nums[l] * nums[l];
            l += 1;
        } else {
            ans[p] = nums[r] * nums[r];
            r -= 1;
        }
    }
    ans
}
```

è¿™ç§å†™æ³•å®Œå…¨é¿å…äº† `n-1` å’Œ `r-=1` çš„ä¸‹æº¢é£é™©ï¼Œæ˜¯æ¨èå†™æ³•ã€‚

---

### äº”ã€æ€»ç»“

|é—®é¢˜|åŸå› |è§£å†³æ–¹æ³•|
|---|---|---|
|`index out of bounds`|`usize` ä¸‹æº¢ (`r = 0; r -= 1 â†’ usize::MAX`)|ä½¿ç”¨æœ‰ç¬¦å·ç´¢å¼• æˆ– ç”¨ `for p in (0..n).rev()`|
|å¾ªç¯æ¡ä»¶ `l <= r` æ°¸è¿œä¸ºçœŸ|å› ä¸º `r` å˜æˆè¶…å¤§æ­£æ•°|ç”¨ `i32` æˆ–é™åˆ¶å¾ªç¯èŒƒå›´|

---

### å…­ã€å­¦ä¹ æ–¹æ³•è®ºä¸ç»ƒä¹ 

**å­¦ä¹ é‡ç‚¹ï¼š**

- ç†è§£ `usize` çš„æ€§è´¨ï¼ˆæ— ç¬¦å·æ•´æ•°ï¼Œä¸èƒ½ä¸ºè´Ÿï¼‰ã€‚
    
- æŒæ¡ Rust çš„è¾¹ç•Œæ£€æŸ¥æœºåˆ¶ï¼ˆè¿è¡Œæ—¶æ£€æŸ¥ + panicï¼‰ã€‚
    
- å­¦ä¼šé€šè¿‡å¾ªç¯æ§åˆ¶å˜é‡é˜²æ­¢ underflowã€‚
    

**ç»ƒä¹ é¢˜ï¼š**

1. å†™ä¸€ä¸ªå‡½æ•° `count_down(n: usize)`ï¼Œå°è¯•ä» n å€’æ•°åˆ° 0ï¼Œè§‚å¯Ÿ underflow ç°è±¡ã€‚
    
2. ç”¨ `for` ä¸ `while` å„å®ç°ä¸€æ¬¡å€’åºå¾ªç¯ï¼Œåˆ†æä¸¤è€…åŒºåˆ«ã€‚
    
3. æ€è€ƒï¼šå¦‚æœè¯­è¨€ä¸è‡ªåŠ¨æ£€æŸ¥è¾¹ç•Œï¼ˆå¦‚ Cï¼‰ï¼Œè¿™ä¸ªé”™è¯¯ä¼šå¯¼è‡´ä»€ä¹ˆï¼Ÿï¼ˆâ†’ é‡æŒ‡é’ˆ / å†…å­˜ç ´åï¼‰
    

**é‡ç‚¹åº•å±‚çŸ¥è¯†ï¼š**

- Rust æ•´æ•°ç±»å‹çš„æº¢å‡ºè§„åˆ™ï¼ˆdebug ä¸‹ panicï¼Œrelease ä¸‹ wraparoundï¼‰ã€‚
    
- `usize` ä¸ `isize` çš„å·®å¼‚ï¼ˆç”¨äºç´¢å¼• vs å¯è¡¨è¾¾è´Ÿå€¼ï¼‰ã€‚

## 4. ä¸å…¶ä»–å¡ç‰‡çš„å…³è”  
- å‰ç½®å¡ç‰‡ï¼š
- åç»­å¡ç‰‡ï¼š
- ç›¸ä¼¼ä¸»é¢˜ï¼š

## 5. åº”ç”¨/å¯å‘  
- å¯ä»¥å¦‚ä½•åº”ç”¨åœ¨å·¥ä½œã€å­¦ä¹ ã€ç”Ÿæ´»ä¸­  
- å¼•å‘çš„æ€è€ƒä¸é—®é¢˜  

## 6. å¾…åŠ/è¿›ä¸€æ­¥æ¢ç´¢  
- [ ] æ·±å…¥é˜…è¯» xxx  
- [ ] éªŒè¯è¿™ä¸ªè§‚ç‚¹çš„è¾¹ç•Œæ¡ä»¶  
