```
# 作业要求：

# 1. 使用 Docker Compose 编排 Golang Web 服务、MySQL 和 Nginx 三个服务。

# 2. Golang Web 服务需实现 /count 路径，计数存储在 MySQL。

# 3. Nginx 反向代理 80 端口到 Web 服务。

# 4. 所有服务通过自定义网络通信，Web 仅对 Nginx 暴露。

# 5. 提供测试脚本验证计数功能。

#

# 说明：

# - app 服务通过 Dockerfile 构建，依赖 MySQL。

# - nginx 服务挂载自定义配置文件。

# - 统一使用 app-network 网络。

# - MYSQL_DSN 环境变量用于配置数据库连接。

# - mysql-data 是 named volume，用于持久化 MySQL 数据。

  

version: '3.8'

networks:

  mynet:

    driver: bridge

  
  

# 在这里编写你的 docker-compose.yml 文件

services:

  mysql:

    image: mysql:8.0

    container_name: my-mysql

    restart: unless-stopped

    environment:

      MYSQL_ROOT_PASSWORD: 123456

      MYSQL_DATABASE: counter

    volumes:

      - mysql-data:/var/lib/mysql

      - ./init.sql:/docker-entrypoint-initdb.d/init.sql:ro

    networks:

      - mynet

  app:

    build: ./app

    container_name: my-app

    restart: unless-stopped

    environment:

      MYSQL_DSN: root:123456@tcp(mysql:3306)/counter

    networks:

      - mynet

    depends_on:

      - mysql

  nginx:

    image: nginx:1.25-alpine

    container_name: my-nginx

    restart: unless-stopped

    ports:

      - "8080:80"

    volumes:

      - ./nginx.conf:/etc/nginx/nginx.conf:ro

    networks:

      - mynet

    depends_on:

      - app

# 定义持久化存储卷

volumes:

  mysql-data:

  
  

# 测试:

# 在这里编写你的 docker-compose.yml 文件

  

# 测试:

# docker compose up -d --build 启动服务

# curl http://localhost:8080/count 验证计数功能
```