---
tags:
  - reference
---

管道（Pipe）是一种基本的**进程间通信（IPC）**机制，它提供了一个单向或双向的数据流通道。根据管道的类型（匿名管道或命名管道），其使用场景有所不同。

### 1. 匿名管道 (Anonymous Pipes) 的一般使用场景

匿名管道是**临时的、单向的**数据流，通常在**有亲缘关系的进程**（如父进程和子进程）之间使用。

| **场景**                   | **描述**                                                                     | **示例 (Shell 或编程)**                                       |
| ------------------------ | -------------------------------------------------------------------------- | -------------------------------------------------------- |
| **Shell 命令链 (Pipeline)** | 这是管道最经典、最常用的场景。将前一个命令的标准输出 (`stdout`) 连接到后一个命令的标准输入 (`stdin`)，形成一个数据处理流水线。 | `ls -l                                                   |
| **父子进程通信**               | 父进程创建子进程后，需要向子进程发送输入数据，或从子进程的计算结果中读取输出数据。                                  | 编程中，父进程通过管道向子进程的 `stdin` 写入配置或任务数据，并从子进程的 `stdout` 读取结果。 |
| **标准 I/O 重定向**           | 在程序执行期间，将某个进程的默认标准输入/输出流重新定向到另一个进程。                                        | `cmd1 < input.txt                                        |
| **任务分工与协同**              | 将一个复杂的任务分解给多个子进程，每个子进程负责数据处理流水线中的一个特定步骤。                                   | 一个进程生成原始数据，通过管道传递给第二个进程进行格式化，再传递给第三个进程进行存储。              |

---

### 2. 命名管道 (Named Pipes / FIFO) 的一般使用场景

命名管道（在 Unix-like 系统中称为 FIFO，在 Windows 中有相应的命名管道）是**持久的、有文件系统入口的**通信通道，允许**不相关进程**之间进行通信。

|**场景**|**描述**|**示例 (Shell 或编程)**|
|---|---|---|
|**本地服务/客户端通信**|一个或多个客户端进程需要与一个长期运行的本地服务器进程（通常是守护进程或服务）通信。通过约定的文件路径访问管道。|一个日志收集守护进程持续监听 `/tmp/log_fifo`，所有应用程序都向该文件写入日志信息。|
|**进程同步和控制**|用于在不相关的进程之间传递控制信号或简单的指令。|一个控制程序向命名管道写入 `shutdown` 命令，另一个守护进程读取该命令后安全退出。|
|**模拟设备/数据源**|将一个命名管道当作一个临时的虚拟设备文件来使用，方便应用程序进行读写操作。|一个应用程序需要从一个“文件”中读取连续数据流，但实际上这个“文件”是一个命名管道，数据由另一个实时生成数据的进程写入。|
|**数据缓冲和解耦**|在生产者和消费者进程之间提供一个数据缓冲区，即使它们启动或运行的节奏不一致，也能保持通信。|生产者以高速率写入数据，而消费者以低速率从 FIFO 读取并处理数据。|

**总结：**

管道是操作系统中实现**进程间通信 (IPC)** 的基础且高效的机制。

- **匿名管道** 适用于**临时**和**相关进程**之间的**流式数据传输**（如 Shell 命令链）。
    
- **命名管道** 适用于**持久**和**不相关进程**之间的**本地通信**（如客户端/服务器模式）。