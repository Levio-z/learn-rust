**拥塞控制 (Congestion Control)** 是 TCP 协议（传输层）中一个至关重要的机制，其核心目的是防止过多的数据被注入到网络中，从而避免网络性能崩溃。

简单来说，**拥塞控制是为了保护整个互联网不被发送端设备的数据量压垮。**

### 1. 什么是“拥塞”？

网络拥塞发生在网络中的**路由器或链路的缓冲区（内存）被数据填满**时。这通常是因为：

1. **发送速率 > 链路容量：** 多个发送方同时向同一条物理链路发送数据，且总速率超过了该链路的承载能力（带宽）。
    
2. **缓冲区溢出：** 路由器来不及处理数据包，其内部的缓存被填满。
    
3. **丢包和时延增加：** 路由器开始丢弃多余的数据包（丢包），同时数据包在排队中等待转发，导致**往返时间 (RTT)** 显著增加（时延）。
    

### 2. 拥塞控制的目的

拥塞控制不是为了让接收方来得及接收数据（那是**流量控制**的工作），而是为了：

1. **最大化利用带宽：** 在不导致拥塞的前提下，尽量提高数据传输速率。
    
2. **避免崩溃（拥塞雪崩）：** 当网络开始出现丢包时，发送方迅速降低发送速率，防止丢包率急剧上升。
    
3. **公平性：** 确保多个 TCP 连接在竞争带宽时，能够相对公平地分配网络资源。
    

### 3. 核心机制：拥塞窗口 (CWND)

TCP 协议在发送端维护一个变量，叫做**拥塞窗口 (Congestion Window,CWND)**。

发送方在一个 RTT（往返时间）内可以发送的数据量，取决于以下两个窗口的较小值：

发送窗口=min(接收窗口 (RWND, 流量控制),拥塞窗口 (CWND, 拥塞控制))

**拥塞控制算法就是一套动态调整 CWND 大小的规则。**

### 4. TCP 拥塞控制的四大经典算法（AIMD 策略）

经典的 TCP 拥塞控制算法主要分为四个阶段，目的是在网络良好时**增（加）**发送速率，在网络拥塞时**减（少）**发送速率（Additive Increase, Multiplicative Decrease, AIMD）。

|阶段|算法名称|CWND 变化规律|触发时机|目的|
|---|---|---|---|---|
|**1. 慢启动**|Slow Start|**指数增长** (每收到一个 ACK，CWND 增加 1 MSS，每次 RTT CWND 加倍)|连接建立或超时重传后|快速探测网络初始可用带宽。|
|**2. 拥塞避免**|Congestion Avoidance|**线性增长** (每收到一个 ACK，CWND 增加 1/CWND，每次 RTT CWND 增加 1 MSS)|CWND 达到慢启动门限 (ssthresh)|谨慎、线性地增加速率，继续探测带宽。|
|**3. 拥塞发生**|Congestion Detection|**乘法递减** (CWND 减半或直接降到 1 MSS)|检测到丢包（通过超时或收到三个重复 ACK）|发生拥塞，必须迅速降低发送速率。|
|**4. 快速恢复**|Fast Recovery|ssthresh 减半，然后 CWND 线性恢复。|收到**三个重复 ACK**（认为拥塞不严重）|在不触发超时的情况下，快速重传丢失的包，并恢复传输，避免慢启动。|