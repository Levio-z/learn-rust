### MAC 包头里的协议类型（EtherType）和使用

以太网帧头包含一个 **类型 (Type)** 字段，通常也被称为 **EtherType**，它告诉接收方设备：这个 MAC 帧解封装后，**上层（网络层）是什么协议**。

这两个协议类型是这样使用的：

#### a. 0800：IP 协议（数据传输）
- **使用时机：** 当设备需要发送 **实际的、承载应用数据的 IP 数据包** 时。
- **阶段：** **数据传输阶段**（依赖于 ARP 已经完成）。
- **工作原理：** 这是一个**单播**传输机制。
- **MAC 层工作：**
    1. 网络层将 **IP 数据包** 准备好。
    2. 数据链路层（MAC 层）在 IP 数据包前面加上 MAC 帧头。
    3. 将 Type 字段设置为 **0800**。
    4. 接收方设备收到该帧，看到 0800 就会知道：它需要将帧头剥离，把剩下的内容（IP 数据包）交给上层的 **IP 协议模块**去处理。
        

#### b. 0806：ARP 协议（地址解析）
- **使用时机：** **发现** 本地网络中某个 IP 地址对应的 **MAC 地址**。 仅在设备**首次**发送数据到某个 IP，且本地 **ARP 缓存中没有** 对应的 MAC 地址时才发生。
- **阶段：** **地址解析/准备阶段**。
- **工作原理：** 这是一个**请求-响应**机制。
	- **请求**帧：`EtherType` 为 0806，MAC 目标地址为**广播**，目的是问：“谁是这个 IP？”
	- **回复**帧：`EtherType` 为 0806，MAC 目标地址为**单播**，目的是答：“我是这个 IP，我的 MAC 是 X。”
- **MAC 层工作：**
    1. 设备构建一个 **ARP 报文**（包含请求或回复信息）。
    2. 数据链路层在 ARP 报文前面加上 MAC 帧头。
    3. 将 Type 字段设置为 **0806**。
    4. 接收方设备收到该帧，看到 0806 就会知道：它需要将帧头剥离，把剩下的内容（ARP 报文）交给**ARP 协议模块**去处理。