![](asserts/Pasted%20image%2020250822103414.png)

### 多Gpu协同
![](asserts/Pasted%20image%2020250822103759.png)

![](asserts/Pasted%20image%2020250822103814.png)


NvLink可以理解为网状结构，一跳或两跳

NIC：网卡

DMA：不需要CPU的干预
### 多GPU协同-节点间
![](asserts/Pasted%20image%2020250822104335.png)

内存带宽T/s，一个传输

InfiniBand更快，造价更高

### 多GPU协同-拓扑信息
![](asserts/Pasted%20image%2020250822104755.png)
![](asserts/Pasted%20image%2020250822104803.png)
- 一共有10个gpu，两个nic的卡
![](asserts/Pasted%20image%2020250822105108.png)
- 不需要经过cpu连接

![](asserts/Pasted%20image%2020250822105143.png)
- 一个连接直接过去
另外一个例子：
![](asserts/Pasted%20image%2020250822105157.png)
![](asserts/Pasted%20image%2020250822105230.png)

![](asserts/Pasted%20image%2020250822105335.png)

### 同步传输
![](asserts/Pasted%20image%2020250822105350.png)
### 异步
![](asserts/Pasted%20image%2020250822105524.png)
![](asserts/Pasted%20image%2020250822105653.png)


![](asserts/Pasted%20image%2020250822105732.png)





![](asserts/Pasted%20image%2020250822105913.png)




![](asserts/Pasted%20image%2020250822110004.png)

![](asserts/Pasted%20image%2020250822110113.png)

![](asserts/Pasted%20image%2020250822112250.png)

![](asserts/Pasted%20image%2020250822133816.png)
- 规约累加操作




![](asserts/Pasted%20image%2020250822134358.png)
![](asserts/Pasted%20image%2020250822135802.png)


![](asserts/Pasted%20image%2020250822135947.png)

![](asserts/Pasted%20image%2020250822140028.png)

![](asserts/Pasted%20image%2020250822140232.png)

![](asserts/Pasted%20image%2020250822140241.png)



![](asserts/Pasted%20image%2020250822140339.png)

![](asserts/Pasted%20image%2020250822140702.png)

![](asserts/Pasted%20image%2020250822140854.png)

![](asserts/Pasted%20image%2020250822141026.png)



![](asserts/Pasted%20image%2020250822141104.png)



![](asserts/Pasted%20image%2020250822141224.png)


![](asserts/Pasted%20image%2020250822141241.png)

![](asserts/Pasted%20image%2020250822141504.png)

![](asserts/Pasted%20image%2020250822141545.png)

![](asserts/Pasted%20image%2020250822141642.png)

![](asserts/Pasted%20image%2020250822141742.png)


![](asserts/Pasted%20image%2020250822141819.png)



![](asserts/Pasted%20image%2020250822141909.png)

![](asserts/Pasted%20image%2020250822141955.png)


![](asserts/Pasted%20image%2020250822142056.png)


![](asserts/Pasted%20image%2020250822142128.png)



![](asserts/Pasted%20image%2020250822142157.png)

![](asserts/Pasted%20image%2020250822142244.png)

![](asserts/Pasted%20image%2020250822142302.png)

![](asserts/Pasted%20image%2020250822142359.png)


![](asserts/Pasted%20image%2020250822142554.png)
- 负无穷
- 正无穷
- 四舍五入，但是向最近的偶数
- 往0方向舍入

### 性能优化
![](asserts/Pasted%20image%2020250822142834.png)

![](asserts/Pasted%20image%2020250822142841.png)

![](asserts/Pasted%20image%2020250822143017.png)
- 追求极致性能，深入PTX优化
![](asserts/Pasted%20image%2020250822143132.png)

做的什么操作，把主机端的数据，转换成

- reg:分配了一些寄存器
- asm：内联汇编
- prmt：进行位的操作，如果是上层的话也有，但是不能保证底层优化成这样子
- 最后move回去
- return

![](asserts/Pasted%20image%2020250822143803.png)


![](asserts/Pasted%20image%2020250822143924.png)
- 不在上层直接提供的功能，是mma的操作

![](asserts/Pasted%20image%2020250822144013.png)


![](asserts/Pasted%20image%2020250822144118.png)
异步拷贝

![](asserts/Pasted%20image%2020250822144153.png)


![](asserts/Pasted%20image%2020250822144202.png)


![](asserts/Pasted%20image%2020250822144237.png)

### 微指令调优
![](asserts/Pasted%20image%2020250822144428.png)

![](asserts/Pasted%20image%2020250822145024.png)

![](asserts/Pasted%20image%2020250822145217.png)![](asserts/Pasted%20image%2020250822145416.png)


![](asserts/Pasted%20image%2020250822145501.png)

### 编译器选项
![](asserts/Pasted%20image%2020250822145611.png)

![](asserts/Pasted%20image%2020250822145820.png)

![](asserts/Pasted%20image%2020250822145912.png)

![](asserts/Pasted%20image%2020250822150125.png)

![](asserts/Pasted%20image%2020250822150346.png)

![](asserts/Pasted%20image%2020250822150400.png)


![](asserts/Pasted%20image%2020250822150502.png)

![](asserts/Pasted%20image%2020250822150539.png)
操作都做，让掩码决定是否写入
性能有明显提升
![](asserts/Pasted%20image%2020250822150623.png)

![](asserts/Pasted%20image%2020250822150639.png)

![](asserts/Pasted%20image%2020250822150751.png)

![](asserts/Pasted%20image%2020250822150830.png)


![](asserts/Pasted%20image%2020250822150920.png)


![](asserts/Pasted%20image%2020250822151103.png)

![](asserts/Pasted%20image%2020250822151226.png)


![](asserts/Pasted%20image%2020250822151315.png)
- 不同的kernel不同的情况
- 算子类别：
- 高层框架自动调优

![](asserts/Pasted%20image%2020250822151530.png)

![](asserts/Pasted%20image%2020250822151621.png)

![](asserts/Pasted%20image%2020250822151704.png)


![](asserts/Pasted%20image%2020250822151727.png)
![](asserts/Pasted%20image%2020250822151833.png)

![](asserts/Pasted%20image%2020250822151915.png)

































