CUDA (Compute Unified Device Architecture)，NVIDIA 开发的并行计算平台和编程模型
### 特点
- C/C++ 语法
	- 宿主语言为C/C++，使用范围广，应用领域对口，新语法学 习门槛低
- 与 CPU 端协作
	- CPU 需负责整理程序执行和处理逻辑等
- SIMT 模式
	- SIMT: Single Instruction Multiple Threads 一个指令可以被多个线程同时执行
- 自动调度
	- 根据设定的执行参数自动调度资源（优化）
### 线程层级结构
◆ SIMT → 指挥每个线程 → 需要组织结构和编号 
◆ CUDA 的方式：Grid → Block → Thread

![](asserts/Pasted%20image%2020250812125957.png)
![](asserts/Pasted%20image%2020250812130017.png)
![](asserts/Pasted%20image%2020250812130059.png)
block和thread编号都是从0开始的

◆ 每个线程独一无二的编号/索引（idx）： 
◆ idx = Block ID * Block Size + Thread ID

### CUDA 编译流程
◆ 每个 cu: Host 代码与 Device 代码分离 
◆ 每个虚拟架构：Device 代码编译出 fatbin 
◆ Host 端使用系统的 C++ 编译器（如 g++) 
◆ 链接（device，host) 
◆ 最终获得可使用 GPU 的可执行二进制文 件 
◆ 疑问：架构是指？
![](asserts/Pasted%20image%2020250812133413.png)
https://docs.nvidia.com/cuda/cuda-compiler-driver-nvcc/#compilation-phases

### 英伟达 GPU 架构
◆前面拿 A100 为例，A100 为 Ampere 架构
◆各个架构间有区别 
◆Compute Capability (CC)
	◆类似版本，表示能支持的功能和指令集合
	◆A100 (Ampere 架构) 是 cc 8.0 
◆虽然 A100 举例，但从 CUDA 编程的角度目前各种架构没有本质区别

![](asserts/Pasted%20image%2020250812133731.png)
- https://en.wikipedia.org/wiki/CUDA#GPUs_supported

◆ 具体列表可参考： 
◆ -arch: https://docs.nvidia.com/cuda/cuda-compiler-driver-nvcc/index.html?highlight=arch#gpu-architecture-arch
◆ -code:https://docs.nvidia.com/cuda/cuda-compiler-driver-nvcc/index.html?highlight=arch#gpu-code-code-code

![](asserts/Pasted%20image%2020250812134303.png)







