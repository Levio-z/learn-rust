```c++
// 通用模板核函数，处理标量或未特化类型
template <typename T>
__global__ void vector_add_kernel(T* c, const T* a, const T* b, size_t n) {
    size_t idx = blockIdx.x * blockDim.x + threadIdx.x;
    if (idx < n) {
        c[idx] = a[idx] + b[idx];
    }
}

// float2 类型的模板特化版本
template <>
__global__ void vector_add_kernel<float2>(float2* c, const float2* a, const float2* b, size_t n) {
    size_t idx = blockIdx.x * blockDim.x + threadIdx.x;
    if (idx < n) {
        c[idx].x = a[idx].x + b[idx].x;
        c[idx].y = a[idx].y + b[idx].y;
    }
}

// float4 类型的模板特化版本
template <>
__global__ void vector_add_kernel<float4>(float4* c, const float4* a, const float4* b, size_t n) {
    size_t idx = blockIdx.x * blockDim.x + threadIdx.x;
    if (idx < n) {
        c[idx].x = a[idx].x + b[idx].x;
        c[idx].y = a[idx].y + b[idx].y;
        c[idx].z = a[idx].z + b[idx].z;
        c[idx].w = a[idx].w + b[idx].w;
    }
}

```