### 函数原型与参数

```cpp
T __shfl_down_sync(unsigned mask, T var, unsigned int delta, int width=32);
```

- **`mask`**：同步掩码，用 32 位整数表示哪些线程参与操作（`0xFFFFFFFF` 表示所有 32 个线程都参与）。
- **`var`**：当前线程要传递出去的数据（任意基础类型，如 `int`、`float` 等）。
- **`delta`**：偏移量（正数），表示当前线程要从 "下方" 第几个线程获取数据（`delta=16` 即从当前线程索引 +16 的线程取数据）。
- **`width`**：可选参数，指定线程束内的逻辑分组大小（默认 32，即整个线程束为一组）。
### 核心功能

**在同一线程束内，让线程 `i` 从线程 `i+delta` 处获取数据，并返回该数据**。当前线程的 `var` 值不会被修改，仅用于传递给上方线程（`i-delta` 的线程）。

形象理解：把 32 个线程想象成一排座位（索引 0~31），`__shfl_down_sync` 就像 "向后传话"—— 线程 `i` 会听到线程 `i+delta` 说的话（即 `var` 值），但自己说的话也会被线程 `i-delta` 听到。


1. **数据流向**：只能从高索引线程向低索引线程传递（"向下" 洗牌）。
    - 线程 `i` 会接收线程 `i+delta` 的 `var` 值。
    - 若 `i+delta >= 32`（超出线程束范围），则返回当前线程自己的 `var` 值（无实际作用）。
2. **原子性**：操作在一个时钟周期内完成，所有线程的数据交换同步发生，无中间状态。
3. **无内存访问**：数据直接在寄存器之间传递，无需经过共享内存或全局内存，因此延迟极低。
