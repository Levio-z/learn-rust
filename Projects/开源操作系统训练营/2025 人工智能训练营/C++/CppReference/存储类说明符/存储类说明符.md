存储类说明符是名称[声明语法](https://en.cppreference.com/w/cpp/language/declarations.html "cpp/language/declarations")的 decl-specifier-seq 的一部分。连同名称的[范围](https://en.cppreference.com/w/cpp/language/scope.html "cpp/language/scope") ，它们控制名称的两个独立属性：其_存储持续时间_和_链接_ 。
### Storage duration
_存储持续时间_是[对象](https://en.cppreference.com/w/cpp/language/objects.html "cpp/language/object")的属性，它定义了包含该对象的存储的最小潜在生存期。存储持续时间由用于创建对象的构造决定，并且是以下内容之一：

- static storage duration   静态存储持续时间

|                                                                                                          |                             |
| -------------------------------------------------------------------------------------------------------- | --------------------------- |
| - thread storage duration (also known as thread-local storage duration)  <br>    线程存储持续时间（也称为线程本地存储持续时间） | (since C++11)  （从 C++11 开始） |

- automatic storage duration  
    自动存储期限
- dynamic storage duration  
    动态存储时长

静态 、线程 （从 C++11 开始） 和自动存储持续时间与[声明](https://en.cppreference.com/w/cpp/language/declarations.html "cpp/language/declarations")引入的对象和[临时对象](https://en.cppreference.com/w/cpp/language/lifetime.html#Temporary_object_lifetime "cpp/language/lifetime")相关联。动态存储持续时间与[新表达式](https://en.cppreference.com/w/cpp/language/new.html "cpp/language/new")创建的对象或[隐式创建的对象](https://en.cppreference.com/w/cpp/language/objects.html#Object_creation "cpp/language/object")相关联。

存储持续时间类别也适用于引用。

[子对象](https://en.cppreference.com/w/cpp/language/objects.html#Subobjects "cpp/language/object")和参考成员的存储持续时间是其完整对象的存储持续时间。

#### Specifiers  说明符

以下关键字是_存储类说明符_ ：

|   |   |
|---|---|
|- auto  自动|(until C++11)  （直到 C++11）|
|- register  注册|(until C++17)  （直到 C++17）|

- static  静态的

|   |   |
|---|---|
|- thread_local|(since C++11)  （从 C++11 开始）|

- extern  外部实习
- mutable  可变

在 decl-specifier-seq 中，最多可以有一个存储类说明符 ，除了 thread_local 可能与 static 或 extern（自 C++11 起） 一起出现 。

可变对存储持续时间没有影响。有关其用法，请参阅 [const/volatile](https://en.cppreference.com/w/cpp/language/cv.html "cpp/language/cv")。

其他存储类说明符可以出现在以下声明的 decl-specifier-seq s 中：

| Specifier   规范               | Can appear in the decl-specifier-seq ﻿s of  <br>可以出现在 的 decl-specifier-seq s 中 |                  |                        |                              |                               |                       |                                                                               |          |     |
| ---------------------------- | ------------------------------------------------------------------------------ | ---------------- | ---------------------- | ---------------------------- | ----------------------------- | --------------------- | ----------------------------------------------------------------------------- | -------- | --- |
| Variable declarations   变量声明 |                                                                                |                  |                        | Function declarations   函数声明 |                               |                       | Structured binding declarations  <br>结构化绑定声明  <br>(since C++17)  （从 C++17 开始） |          |     |
| Non-member   非会员             |                                                                                | Member   成员      |                        | Non-member   非会员             | Member   成员                   |                       |                                                                               |          |     |
| Non-parameter   非参数          | Function parameter   功能参数                                                      | Non-static   非静态 | Static    静态的          | Non-static   非静态             | Static    静态的                 |                       |                                                                               |          |     |
| auto  自动                     | Block scope only  仅块范围                                                         | Yes  是的          | No  不                  | No   不                       | No  不                         | No  不                 | No  不                                                                         | N/A  不适用 |     |
| register  注册                 | Block scope only  仅块范围                                                         | Yes  是的          | No  不                  | No   不                       | No  不                         | No  不                 | No  不                                                                         | N/A  不适用 |     |
| static  静态的                  | Yes  是的                                                                        | No  不            | Declares static   声明静态 |                              | Namespace scope only  仅命名空间范围 | Declares static  声明静态 |                                                                               | Yes   是的 |     |
| thread_local                 | Yes  是的                                                                        | No  不            | No  不                  | Yes   是的                     | No  不                         | No  不                 | No  不                                                                         | Yes   是的 |     |
| extern  外部实习                 | Yes  是的                                                                        | No  不            | No  不                  | No   不                       | Yes  是的                       | No  不                 | No  不                                                                         | No   不   |     |

## 2️⃣ 按存储类说明符解析

### (1) `auto`
-   仅可用于 **块作用域变量声明（Block scope only）**
-   不可用于：
    -   类成员变量（Member）  
    -   函数返回类型或参数（Function declarations / Function parameter）   
- 从 **C++14/C++17 起**，函数模板参数或者 **泛型 lambda** 参数可以写 `auto`
```
// 函数模板
auto add(auto a, auto b) { return a + b;
// 泛型 lambda
auto lambda = [](auto x, auto y){ return x + y; };
```
✅  对于结构化绑定（C++17）：可以与 `auto` 一起使用
例子：
```cpp
void f() {
    auto x = 42;              // OK
    auto [a, b] = std::pair{1,2}; // C++17 结构化绑定
}
```
---
### (2) `register`
-   仅可用于 **块作用域变量**
-   不可用于：
    -   成员变量  
    -   函数参数
    -   结构化绑定
-   已废弃（C++17 移除）
✅ 例子：
```cpp
void f() {
    register int x = 0;  // 提示放入寄存器
}
```
---
### (3) `static`
-   可用于：
    -   **非成员变量**（块作用域） → 局部静态变量
    -   **成员变量** → 类静态成员
    -   **命名空间作用域变量** → 内部链接（internal linkage）
-   不可用于：
    -   函数参数
    -   结构化绑定
✅ 例子：
```cpp
void f() {
    static int x = 0; // 局部静态
}

class A {
    static int count;  // 类静态成员
};

namespace {
    static int g = 42; // 命名空间内部链接
}
```
---
### (4) `thread_local`
-   可用于：
    -   **非成员变量**（块作用域）
    -   **静态成员变量**
    -   **结构化绑定不适用**
-   不可用于：
    -   成员函数
    -   非静态成员变量
✅ 例子：
```cpp
thread_local int x = 0;   // 线程局部变量

class A {
    static thread_local int counter; // 静态线程局部成员
};
```
---
### (5) `extern`
-   可用于：
    -   **命名空间作用域变量**（非成员） → 声明外部变量
    -   函数声明 → 外部函数
-   不可用于：
    -   类成员
    -   函数参数
    -   块作用域内部变量（除非你是引用全局变量）

✅ 例子：
```cpp
extern int g;  // 声明其他文件的全局变量
extern void foo(); // 外部函数
```
---
## 3️⃣ 总结
-   **块作用域变量** → 可以使用 `auto`、`register`、`static`、`thread_local`、`extern`（部分情况下）
-   **类成员变量** → 只能使用 `static` 或 `thread_local`（静态线程局部）
-   **函数声明** → `extern` 可用
-   **结构化绑定（C++17）** → 只有 `auto`、`thread_local` 可与之组合

> 核心概念：**存储类说明符不仅控制存储期，还与作用域、链接性、成员属性紧密相关**。




