如下图所示，现在通用操作系统（如 Linux 等）上的应用程序运行需要下面多层次的执行环境栈的支持，图中的白色块自上而下（越往下则越靠近底层，下层作为上层的执行环境支持上层代码的运行）表示各级执行环境，黑色块则表示相邻两层执行环境之间的接口。

![](asserts/Pasted%20image%2020250901222740.png)

我们的应用位于最上层，它可以通过调用编程语言提供的标准库或者其他三方库对外提供的函数接口，使得仅需少量的源代码就能完成复杂的功能。但是这些库的功能不仅限于此，事实上它们属于应用程序 执行环境 (Execution Environment)的一部分。在我们通常不会注意到的地方，这些**软件库还会在执行应用之前完成一些初始化工作，并在应用程序执行的时候对它进行监控**。

从操作系统内核的角度看来，它上面的一切都属于用户态软件，而它自身属于内核态软件。
- 无论用户态应用如何编写，某些功能总要直接或间接的通过操作系统内核提供的 **系统调用** (System Call) 来实现。因此**系统调用充当了用户和内核之间的边界**。**内核作为用户态软件的执行环境，它不仅要提供系统调用接口，还需要对用户态软件的执行进行监控和管理**。

从硬件的角度来看，它上面的一切都属于软件。硬件可以分为三种： 处理器 (Processor，也称CPU)，内存 (Memory) 还有 I/O 设备。其中处理器无疑是其中最复杂，同时也最关键的一个。它与软件约定一套 **指令集体系结构** (ISA, Instruction Set Architecture)，使得软件可以通过 ISA 中提供的机器指令来访问各种硬件资源。软件当然也需要知道处理器会如何执行这些指令，以及指令执行后的结果。当然，实际的情况远比这个要复杂得多，为了适应现代应用程序的场景，处理器还需要提供很多额外的机制（如特权级、页表、TLB、异常/中断响应等）来管理应用程序的执行过程，而不仅仅是让数据在 CPU 寄存器、内存和 I/O 设备三者之间流动。


- **执行环境**（Execution Environment, EE）是上层程序运行所依赖的基础设施。
- 它主要提供两类功能：
    1. **初始化功能**：在应用程序运行之前，执行环境需要完成底层硬件和资源的初始化（如 CPU、内存、外设等），确保上层程序能正常运行。
    2. **运行时服务功能**：在应用程序运行时，提供一些上层无法直接访问的底层服务（如系统调用、IO、硬件接口访问）。
类比：在操作系统中，执行环境类似于一层“中间层”，介于硬件和内核之间，它屏蔽硬件细节，同时为内核或上层应用提供基础服务。