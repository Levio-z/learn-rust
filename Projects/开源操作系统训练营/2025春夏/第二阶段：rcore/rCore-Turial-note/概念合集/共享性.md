共享是指**多个应用并发运行时，宏观上体现出它们可同时访问同一个资源，即这个共享（Sharing）是操作系统的一个基本特性，指多个程序**并发执行**时，能够**宏观上同时使用某一类资源**。
- **宏观角度**：应用层观察，多个程序似乎在“同时”访问同一个资源。
- **微观角度**：由于资源有限，操作系统必须通过**互斥机制**和**调度机制**，在任意时刻只允许一个访问者进入临界区，从而保证数据正确性。
### 单核处理器下的共享
- **表象**：两个应用能同时读取或修改同一内存单元。
- **实际实现**：
    - 处理器在一个时刻只能执行一个进程的指令。
    - 操作系统通过 **时间片轮转** 或 **优先级调度** 等策略，使进程交替执行。
    - 对共享资源的访问需要加锁（例如互斥锁、信号量），避免竞态条件。

➡️ 结果：宏观上“同时”，微观上“串行互斥”。
### 多核处理器下的共享
- **复杂性增加**：多个 CPU 核**确实可能同时执行不同的进程**，并发访问同一内存地址。
- **操作系统的作用**：提供互斥原语（锁、信号量、自旋锁等），避免逻辑层面的冲突。
- **硬件的作用**：提供 **缓存一致性协议（Cache Coherence Protocols）**，例如 MESI 协议，确保每个 CPU 核看到的共享内存数据是一致的。
    
➡️ 没有硬件支持，仅靠 OS 无法保证数据一致性。

### 共享与互斥的关系

- **共享**：资源能被多个进程使用。
- **互斥**：保证某一时刻资源只能被一个进程使用。  
    二者是一对矛盾统一体：
- 没有互斥，就无法正确地共享；
- 没有共享，互斥也失去了意义。
### 小结
- 共享是 OS 的基本特性之一，分为宏观并发和微观串行两层实现。
- 单核下的共享，本质是通过时间分片和互斥机制实现的“伪并行”。
- 多核下的共享，更依赖硬件级缓存一致性（如 MESI 协议），否则会出现数据不一致。
- 共享与互斥是相辅相成的概念，操作系统通过同步机制和硬件协同保证正确共享
### 学习方法
1. **概念分层**：先区分宏观现象（并发）与微观实现（互斥）。
2. **单核 → 多核**：理解共享在单核下的“伪并行”，再扩展到多核的真实并行。
3. **软硬结合**：掌握 OS 提供的同步机制（锁、信号量），同时理解硬件的缓存一致性协议。