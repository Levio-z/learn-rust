04-bare_bones-testing
### 功能
- [36 自定义测试框架](../ChatGpt/4.0%20测试/36%20自定义测试框架.md)
	- std 测试框架依赖于标准库，我们需要自定义测试框架
	- 定义一个测试框架
	- 原理
		- 收集所有标注了 `#[test_case]`属性的函数，然后将这个测试函数的列表作为参数传递给用户指定的runner函数。
	- 默认：自定义测试框架会使用main函数来调用test_runner
		- `#[no_main]`并提供了我们自己的入口点，所以这个`main`函数就被忽略了。需要自己处理入口点逻辑。
	- 处理逻辑
		- 在_start中调用
		- 重命名函数，因为no_main不会识别
		- 调用test_runner
		- 条件编译 只在测试上下文中生成
- [37 退出QEMU](../ChatGpt/4.0%20测试/37%20退出QEMU.md)
	- 通过端口映射io退出
		- QEMU支持一种名为 `isa-debug-exit` 的特殊设备 **端口映射I/O** 来退出
		- 向端口写入退出码 =>qemu退出
	- `cargo test` 会将所有非 `0` 的错误码都视为测试失败
		- 将指定的退出代码映射到退出代码 `0`
- [38 打印到控制台](../ChatGpt/4.0%20测试/38%20打印到控制台.md)
	-  通过串口发射到控制台
	- 使用 `-serial` 参数将输出重定向到stdout：
	- 条件编译：测试时panic可以打印信息到控制台
	- 隐藏qemu窗口，支持没有图形的界面测试
	- 超时设置：`bootimage` 工具默认为每个可执行测试设置了一个长度为5分钟的超时时间
	- 自动添加打印语句
		- 使用一个泛型接受
- [39 测试VGA缓冲区](../ChatGpt/4.0%20测试/39%20测试VGA缓冲区.md)
	- 测试
- [40 集成测试](../ChatGpt/4.0%20测试/40%20集成测试.md)
	- 创建库
	- panic测试，暂时只能处理一个
	- 禁用testrunner，这里的关键就是在 `Cargo.toml` 中为测试禁用 `harness` flag，这个标志（flag）定义了是否将test runner用于集成测试中。
	- 这样一来该测试就可以像一个普通的可执行程序一样运行了。