> https://en.wikipedia.org/wiki/Volatile_(computer_programming)


在[计算机编程](https://en.wikipedia.org/wiki/Computer_programming "Computer programming")中，如果变量的[值](https://en.wikipedia.org/wiki/Value_\(computer_science\) "Value (computer science)")可以被当前[执行线程](https://en.wikipedia.org/wiki/Thread_\(computing\) "Thread (computing)")以外的东西异步读取或修改，则该[变量](https://en.wikipedia.org/wiki/Variable_\(computer_science\) "Variable (computer science)")被称为_**易失性**_变量。易`失`变量的值可能会自发变化，原因如下：与其他线程共享值;与异步[信号处理程序](https://en.wikipedia.org/wiki/Signal_handler "Signal handler")共享值;通过[内存映射 I/O](https://en.wikipedia.org/wiki/Memory-mapped_I/O "Memory-mapped I/O") 访问硬件设备（您可以通过读取和写入内存来发送和接收来自[外围设备的](https://en.wikipedia.org/wiki/Peripheral_device "Peripheral device")消息）。对这些用例的支持在具有 `volatile` 关键字的编程语言之间差异很大。易失性可能会对函数[调用约定](https://en.wikipedia.org/wiki/Calling_convention "Calling convention")以及变量的存储、访问和缓存方式产生影响。


### 易失性变量的关键概念

1. **异步修改与读取**：
    
    - **这些变量的值可能在程序执行过程中被其他线程、硬件中断、外部事件或信号处理程序等异步地修改或读取**。
	    - 例如，操作系统中的中断处理程序、硬件寄存器的值或某个共享内存区域的内容，都可能是易失的。
		- “**异步修改与读取**”意味着变量的值可以在程序运行时由外部因素（如其他线程、硬件中断、外部事件、信号处理程序等）改变，因此，程序的主线程在读取该变量时不能依赖它的值不会被改变
        
2. **对编译器优化的影响**：
    
    - 编译器通常会对变量进行优化，比如将变量的值保存在寄存器中，减少内存访问次数。然而，易失性变量不能被编译器优化，因为它们的值可能在每次访问时都发生变化，或者可能会被外部环境改变。所以，**编译器必须保证每次访问易失性变量时都会从内存中读取最新的值，而不是从寄存器或缓存中获取**。
        
3. **内存映射 I/O**：
    
    - 在嵌入式编程或操作系统开发中，易失性变量**通常用于直接映射到硬件寄存器、外设或内存映射 I/O 区域**。这些区域的值**会随着硬件的操作或事件的发生而变化，程序需要每次都直接从内存中读取这些值，以确保获取最新的硬件状态**。