对可编程的中断控制器进行设置，以将硬件中断转发给CPU

#### 1. 中断的概念与作用
中断（Interrupt）是硬件或外部事件主动通知CPU需要处理的信号，它允许CPU在不轮询的情况下响应外部事件。核心特点：
- **异步性**：中断可以在任何时刻发生，不依赖于当前执行代码。
- **事件驱动**：CPU响应中断时，会暂停当前程序执行，转而执行中断处理逻辑。
- **降低延时**：相比轮询机制，响应速度快，节省CPU资源。

[硬件中断](../../../../开源操作系统训练营/2025春夏/第二阶段：rcore/rCore-Turial-note/概念合集/硬件中断.md)

```
                                    ____________             _____
               Timer ------------> |            |           |     |
               Keyboard ---------> | Interrupt  |---------> | CPU |
               Other Hardware ---> | Controller |           |_____|
               Etc. -------------> |____________|
```
### 2. 中断控制器（PIC）的角色
直接让所有硬件中断信号接入CPU不现实，因此需要中断控制器（Interrupt Controller）进行统一管理。其作用包括：
- **汇总中断请求**：所有外设中断先汇总到控制器。
- **优先级管理**：可以设定不同中断的优先级，例如定时器高于键盘。
- **转发中断**：控制器根据优先级和屏蔽设置将中断信号发送给CPU。
结构示意：
```
Timer ---------> |              |
Keyboard ------> | Interrupt    | -----> CPU
Other Hardware ->| Controller   |
Etc. ---------> |______________|
```
现代PC中，常见可编程中断控制器有**8259A PIC**和**APIC**，它们都支持向CPU发送中断信号，并可进行级联和优先级管理。

### 3. 中断处理机制

在内核中处理硬件中断的流程：
1. **中断发生**：外设通过PIC(rogrammable interrupt controller)通知CPU。
2. **CPU暂停当前执行**：保存现场（寄存器、程序计数器等）。
3. **跳转到中断服务程序（ISR）**：内核在**中断描述符表（IDT）**中查找对应中断向量。
4. **执行ISR**：处理事件，例如读取键盘扫描码或更新系统时间。
5. **中断返回**：恢复CPU现场，继续原程序执行。

关键点：

- **ISR在CPU层面类似异常处理**：都需要IDT条目，但中断是异步的。
- **异步安全问题**：全局可变状态在中断上下文中访问可能产生竞态，Rust的所有权模型能部分防护此类问题。