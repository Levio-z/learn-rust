**只有在“不会被异步中断或信号打断”的用户态代码中，红区才能安全使用。**

1. **减少函数栈指针调整指令**
	- 对于 **小型、简单的叶函数**（leaf function，不调用其他函数），每次调整栈指针开销显得比较明显；
2. 提供一个固定大小的、函数调用时不被破坏的栈区
	- 红区定义为栈指针（`rsp`）下方**128字节**大小的区域；
	- 该区域在函数调用期间保证不被其他函数破坏（ABI 约定），函数可以安全地在这片区域内临时存储数据；
	- 使用红区时，函数无需调整栈指针就可以直接使用这128字节空间；
3. **提升函数调用性能**
	- 通过避免频繁修改栈指针，减少汇编指令数量；
	- 让编译器生成更紧凑、更高效的代码，特别是对于短小的叶函数；
	- 加快函数执行速度，节省 CPU 周期。
### 红区的危险
- 使用红区时必须**小心异常处理和中断，因为它们可能会覆盖红区数据**，造成难以调试的错误，这也是为什么有些场景需要禁用红区。
- 因此只有 **短小且不会被异步打断的代码（比如叶函数、纯 CPU 运算）** 可以安全使用红区；
	- 叶函数：不调用其他函数的函数，是调用树的叶子节点
#### 解决方案
1. 用户态：**编译器和 ABI 约定避免使用红区的危险**
	- 编译器遵循 ABI 约定，确保只有在**确定不会被中断的代码路径**使用红区；
	- 如果果函数可能被中断或异常打断，则会避免利用红区，而是正常调整栈指针。
- 3. **内核开发、裸机环境、实时系统**：**禁用红区作为安全保障**
	- 对于**内核开发、裸机环境、实时系统**等对异常和中断极端敏感的场景，Linux 内核源码和裸机程序往往会禁用红区（通过 `disable-redzone`）；
	- 这样避免任何可能的栈数据损坏风险，换取一些性能上的牺牲。