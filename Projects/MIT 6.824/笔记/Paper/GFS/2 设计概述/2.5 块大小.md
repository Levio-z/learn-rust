块大小是关键设计参数之一。我们选择了 64 MB，这比典型的文件系统块大小大得多。 每个块副本都作为纯 Linux 文件存储在块服务器上，并且仅根据需要进行扩展。惰性空间分配避免了由于内部碎片而浪费空间，这也许是对如此大的块大小的最大反对。


大块大小提供了几个重要的优势。

首先，它**减少了客户端与主节点交互的需要**，因为在同一块上的读取和写入只需要向主节点发出一个块位置信息的初始请求。这种减少对于我们的工作负载来说尤其重要，因为**应用程序大多按顺序读取和写入大文件**。即使对于小型随机读取，客户端也可以轻松缓存数 TB 工作集的所有块位置信息。

其次，由于在一个大块上，客户端更有可能在给定块上执行许多操作。它可以通过在较**长时间内保持与块服务器的持久 TCP 连接来减少网络开销**。

第三，它**减小了存储在主服务器上的元数据的大小**。这使我们能够将元数据保存在内存中，这反过来又带来了我们将在第 2.6.1 节中讨论的其他优势。

另一方面，即使有延迟空间分配，大块也有其缺点。一个小文件由少量块组成，也许只有一个。**如果许多客户端访问同一个文件，存储这些块的块服务器可能会成为热点**。在实践中，热点并不是一个主要问题，因为我们的应用程序大多按顺序读取大型多块文件。

然而，当 GFS 首次被批处理队列系统使用时，热点确实出现了：可执行文件作为单个块文件写入 GFS，然后同时在数百台机器上启动。存储此可执行文件的少数块服务器因数百个同时请求而过载。**我们通过使用更高的复制因子存储此类可执行文件并使 batchqueue 系统错开应用程序启动时间来解决这个问题。一个潜在的长期解决方案是允许客户端在这种情况下从其他客户端读取数据。**

