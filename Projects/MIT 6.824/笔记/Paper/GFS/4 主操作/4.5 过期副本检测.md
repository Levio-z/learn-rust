如果 chunkserver 失败并在 chunk 关闭时错过了对 chunk 的突变，则 chunk 副本可能会变得过时。对于每个块，主节点维护一个块版本号，以区分最新的副本和过时的副本。

每当主节点授予对块的新租约时，它都会增加块版本号并通知最新的副本。主服务器和这些副本都记录了永久状态下的新版本号。这发生在任何客户端收到通知之前，因此在它开始写入块之前。如果另一个副本当前不可用，则不会提前其块版本号。当 chunkserver 重新启动时，主服务器将检测到此 chunkserver 具有过时的副本，并报告其块集及其关联的版本号。如果主服务器看到的版本号大于其记录中的版本号，则主服务器会假定它在授予租约时失败，因此将较高版本视为最新版本。

主服务器在其常规垃圾回收中删除过时的副本。在此之前，当它回复客户端对块信息的请求时，它实际上认为过时的副本根本不存在。 作为另一种保护措施，当主服务器通知客户端哪个 chunkserver 持有某个块的租约时，或者当它指示 chunkserver 在克隆作中从另一个 chunkserver 读取块时，它会包含块版本号。客户端或块服务器在执行作时验证版本号，以便始终访问最新数据。