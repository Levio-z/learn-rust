创建块副本的原因有三个：块创建、重新复制和重新平衡。

当主节点创建块时，它会选择放置最初为空的副本的位置。它考虑了几个因素。
（1） 我们希望将新的副本放置在磁盘空间利用率低于平均水平的块服务器上。 随着时间的推移，这将平衡块服务器之间的磁盘利用率。
（2） 我们希望限制每个块服务器上“最近”创建的数量。尽管创建本身很便宜，但它可靠地预测了即将发生的大量写入流量，因为块是在写入要求时创建的，并且在我们的附加一次读取多次工作负载中，一旦它们完全写入，它们通常实际上就变成了只读。
（3） 如上所述，我们希望将块的副本分布在机架上。

一旦可用副本的数量低于用户指定的目标，主节点就会重新复制一个块。发生这种情况的原因有多种：chunkserver 变得不可用，它报告其副本可能已损坏，其一个磁盘由于错误而被禁用，或者复制目标增加。每个需要重新复制的块都会根据几个因素确定优先级。一是它离复制目标有多远。例如，我们对丢失两个副本的块给予更高的优先级，而不是仅丢失一个副本的块。此外，我们更喜欢首先重新复制实时文件的块，而不是属于最近删除的文件的块（参见第 4.4 节）。最后，为了最大程度地减少故障对正在运行的应用程序的影响，我们提高了阻止客户端进度的任何块的优先级。

