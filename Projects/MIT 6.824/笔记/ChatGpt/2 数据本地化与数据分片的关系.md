### 定义
**数据本地化（Data Locality）**指的是尽量让数据存储和使用数据的计算/访问操作靠近，减少数据访问时跨网络传输的需求。

在分布式系统或分布式存储中，数据通常被分成多个分片（Sharding）存放在不同服务器节点上。**数据本地化**的目标就是让客户端或中间层访问数据时，能够“直达”存储该数据的那个节点，而不是先访问一个节点，再通过它转发到真正存储数据的节点。

### 为什么：核心问题是“延迟”
- 网络传输的**延迟**主要来自于：
    1. **网络跳数（hop count）**：数据包从客户端到目标服务器经**过多个中间路由器或节点，每经过一次路由，都会有一定时间开销**。
    2. **跨节点通信开销**：当请求不能直接到达数据所在节点时，数据需要在多个服务器间传递，**中间转发带来额外延迟和资源消耗**。
    3. **数据迁移**：数据被动态迁移时，访问者需要等待迁移完成或从多个地方查询，导致响应变慢。？？
        
- 延迟高，意味着用户体验差，系统响应变慢，甚至影响整体吞吐量。

| 方面   | 数据分片（Sharding）      | 数据本地化（Data Locality）  |
| ---- | ------------------- | --------------------- |
| 目的   | 将大数据分成多个分片，分布到不同服务器 | 使访问请求尽量直接到达存储数据的节点    |
| 关注点  | 数据的物理拆分和存储          | 数据访问路径和访问效率           |
| 依赖关系 | 数据本地化依赖于数据分片的存在和规则  | 数据分片需要配合数据本地化策略才能高效使用 |
| 作用   | 实现扩展性和负载分担          | 减少延迟、减少网络跳数、提高性能      |
| 体现形式 | 多个分片分布在多台机器         | 客户端或中间层根据分片规则直接访问对应节点 |
- **数据分片是实现数据本地化的基础**。  
    只有数据被分片存储到不同节点，才存在“本地化访问”的必要性。
    
- **数据本地化是数据分片应用的优化策略**。  
    当你知道数据分片规则后，能通过数据本地化策略直接访问目标分片，避免中间转发。
### 四、举例说明

假如有一个没有分片的单体数据库，所有数据都在一个节点，数据本地化的问题不存在，因为只有一个数据位置。

而在分片后：

- 如果客户端不了解分片规则，访问时只能访问一个中间层，再由中间层查询具体分片，这时就会产生额外网络跳数，导致延迟变高。
    
- 如果客户端了解分片规则，能够直接访问目标分片的服务器，这就是数据本地化的体现，延迟明显降低。

### 五、总结

- **数据分片是把数据拆开放置，解决存储扩展和容量限制。**
    
- **数据本地化是利用分片规则让访问路径最短、直接，从而降低请求延迟。**