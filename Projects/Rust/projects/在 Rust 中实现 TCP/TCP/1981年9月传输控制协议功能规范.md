```
  
  
                              +---------+ ---------\      active OPEN
                              |  CLOSED |            \    -----------
                              +---------+<---------\   \   create TCB
                                |     ^              \   \  snd SYN
                   passive OPEN |     |   CLOSE        \   \
                   ------------ |     | ----------       \   \
                    create TCB  |     | delete TCB         \   \
                                V     |                      \   \
                              +---------+            CLOSE    |    \
                              |  LISTEN |          ---------- |     |
                              +---------+          delete TCB |     |
                   rcv SYN      |     |     SEND              |     |
                  -----------   |     |    -------            |     V
 +---------+      snd SYN,ACK  /       \   snd SYN          +---------+
 |         |<-----------------           ------------------>|         |
 |   SYN   |                    rcv SYN                     |   SYN   |
 |   RCVD  |<-----------------------------------------------|   SENT  |
 |         |                    snd ACK                     |         |
 |         |------------------           -------------------|         |
 +---------+   rcv ACK of SYN  \       /  rcv SYN,ACK       +---------+
   |           --------------   |     |   -----------
   |                  x         |     |     snd ACK
   |                            V     V
   |  CLOSE                   +---------+
   | -------                  |  ESTAB  |
   | snd FIN                  +---------+
   |                   CLOSE    |     |    rcv FIN
   V                  -------   |     |    -------
 +---------+          snd FIN  /       \   snd ACK          +---------+
 |  FIN    |<-----------------           ------------------>|  CLOSE  |
 | WAIT-1  |------------------                              |   WAIT  |
 +---------+          rcv FIN  \                            +---------+
   | rcv ACK of FIN   -------   |                            CLOSE  |
   | --------------   snd ACK   |                           ------- |
   V        x                   V                           snd FIN V
 +---------+                  +---------+                   +---------+
 |FINWAIT-2|                  | CLOSING |                   | LAST-ACK|
 +---------+                  +---------+                   +---------+
   |                rcv ACK of FIN |                 rcv ACK of FIN |
   |  rcv FIN       -------------- |    Timeout=2MSL -------------- |
   |  -------              x       V    ------------        x       V
    \ snd ACK                 +---------+delete TCB         +---------+
     ------------------------>|TIME WAIT|------------------>| CLOSED  |
                              +---------+                   +---------+
```
### 📘 **一、各状态定义与作用**

| 状态名             | 定义与作用                                            |
| --------------- | ------------------------------------------------ |
| **CLOSED**      | 初始状态，无连接存在，TCP 控制块（TCB）不存在。                      |
| **LISTEN**      | 服务端监听状态，等待客户端发起连接（`passive OPEN`）。               |
| **SYN-SENT**    | 主动连接状态，客户端发送 SYN 后，等待服务端回应（`active OPEN`）。       |
| **SYN-RCVD**    | 服务端收到 SYN 后，发送 SYN-ACK，等待客户端 ACK。                |
| **ESTABLISHED** | 双方已建立连接，可开始数据传输。                                 |
| **FIN-WAIT-1**  | 主动关闭方发送 FIN，等待对方 ACK 或 FIN。                      |
| **FIN-WAIT-2**  | 收到对方对 FIN 的 ACK，等待对方的 FIN。                       |
| **CLOSING**     | 双方几乎同时关闭，等待对方的 ACK。                              |
| **LAST-ACK**    | 被动关闭方发送 FIN，等待对方 ACK。                            |
| **TIME-WAIT**   | 主动关闭方收到 FIN 后，进入等待（2 * MSL，最大报文生存时间）以确保对方收到 ACK。 |
| **CLOSED**      | 最终状态，TCP 连接释放，TCB 被删除。                           |
