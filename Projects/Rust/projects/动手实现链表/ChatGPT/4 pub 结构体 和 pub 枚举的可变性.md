## 1\. `pub struct` 与字段可见性

```rust
pub struct List {
    head: Link,
}
```

-   `List` 是 `pub`，**对外可见**，可以被模块外访问和使用。
    
-   `head` 字段默认是私有的（没有 `pub`），因此**模块外无法直接访问或看到 `head` 字段的类型 `Link`**。
    
-   因此，Rust **不会要求** `Link` 必须是 `pub`，因为外部代码无法直接接触 `head` 字段，也就不需要知道 `Link` 是什么。
    
-   **简言之：字段私有，字段类型可私有。**
    

---

## 2\. `pub enum` 与变体字段可见性

```rust
pub enum List {
    Empty,
    More(Box<Node>),
}
```

-   `List` 是 `pub`，整个枚举及其所有变体默认也是 `pub`。
    
-   **枚举的所有变体（variants）默认是 `pub` 的，且其字段也是 `pub` 的。**
    
-   因为模块外可以通过 `List::More(...)` 访问 `More` 变体和其字段。
    
-   这就要求 `More` 变体中字段的类型 `Box<Node>` 必须是对外可见的。
    
-   **如果 `Node` 不是 `pub`，就会报错：变体字段的类型比变体本身还要“私有”，造成可见性冲突。**
    

---

## 3\. 为什么枚举和结构体不一样？

-   结构体：字段默认是私有的，外部无法访问，所以不会强制字段类型公开。
    
-   枚举：变体默认是公开的，外部可以通过 `List::More(...)` 直接访问变体字段，字段的类型必须是公开的。
    

---

## 4\. 如何避免枚举中的可见性冲突？

-   显式地将变体字段标记为私有：
    
    Rust 枚举中的元组变体的字段默认是 `pub`，但如果你用**具名字段**的方式定义枚举（即“结构体变体”），你可以控制字段的可见性：
    
    ```rust
    pub enum List {
        Empty,
        More { node: Box<Node> }, // 这个字段默认私有，外部不可见
    }
    ```
    
-   或者将 `Node` 设为 `pub`，保证它对外可见：
    
    ```rust
    pub struct Node {
        elem: i32,
        next: Link,
    }
    ```
    
-   或者把整个 `List` 设为私有或者限定可见性：
    
    ```rust
    enum List { ... } // 私有枚举，无需对变体字段可见性担忧
    ```
    

---

## 5\. 综上总结

| 情况 | 字段默认可见性 | 是否要求字段类型公开 | 说明 |
| --- | --- | --- | --- |
| `pub struct` | 字段私有 | 不要求 | 字段私有，外部无法访问字段类型 |
| `pub enum` 元组变体字段 | 字段公有 | 要求 | 外部可访问变体字段，要求类型公开 |
| `pub enum` 结构体变体字段 | 字段私有 | 不要求 | 结构体变体字段默认私有，类型可私有 |

---

## 6\. 小结

> **“pub 结构体不会要求所有成员必须是 pub”**是对的，因为结构体字段默认私有；  
> 而**“pub 枚举的元组变体默认字段是 pub”**，这才会导致必须让字段类型公开，否则产生冲突。

---