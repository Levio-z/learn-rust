å®‰è£…åï¼Œä½ ä¼šè·å¾—ä»¥ä¸‹ 3 ä¸ªä¸»è¦å­å‘½ä»¤ï¼š

---

### 1ï¸âƒ£ `cargo add`

> âœ… å‘ `Cargo.toml` æ·»åŠ ä¾èµ–é¡¹ï¼Œè‡ªåŠ¨å¤„ç†ç‰ˆæœ¬ã€ç‰¹æ€§ã€ç±»å‹ï¼ˆdev/buildï¼‰ç­‰ã€‚

#### å¸¸è§ç”¨æ³•ï¼š

```bash
cargo add serde                       # æ·»åŠ  serde åˆ° dependencies
cargo add tokio --features full       # æ·»åŠ  tokio å¹¶å¯ç”¨ full ç‰¹æ€§
cargo add anyhow@1.0.75               # æŒ‡å®šç‰ˆæœ¬
cargo add rstest --dev                # æ·»åŠ åˆ° [dev-dependencies]
cargo add cc --build                  # æ·»åŠ åˆ° [build-dependencies]
```

âœ… è‡ªåŠ¨è§£ææœ€æ–°ç‰ˆæœ¬  
âœ… è‡ªåŠ¨æ·»åŠ  `features`ã€`optional`  
âœ… ä¸ç”¨æ‰‹åŠ¨ä¿®æ”¹ `Cargo.toml`

---

### 2ï¸âƒ£ `cargo rm`

> âŒ ä» `Cargo.toml` ä¸­ç§»é™¤ä¾èµ–é¡¹ã€‚

#### ç”¨æ³•ç¤ºä¾‹ï¼š

```bash
cargo rm serde
cargo rm anyhow --dev
```

ä¼šä»ç›¸åº”çš„ `[dependencies]` / `[dev-dependencies]` / `[build-dependencies]` ä¸­ç§»é™¤æŒ‡å®šé¡¹ã€‚

---

### 3ï¸âƒ£ `cargo upgrade`

> â¬†ï¸ å°† `Cargo.toml` ä¸­çš„ä¾èµ–å‡çº§ä¸ºæœ€æ–°ç‰ˆæœ¬ï¼ˆæˆ–æŒ‡å®šç‰ˆæœ¬ï¼‰

#### ç”¨æ³•ç¤ºä¾‹ï¼š

```bash
cargo upgrade                       # å‡çº§å…¨éƒ¨ä¾èµ–åˆ°æœ€æ–°ç¨³å®šç‰ˆ
cargo upgrade serde                 # å‡çº§æŸä¸€ä¸ªä¾èµ–
cargo upgrade --incompatible        # å…è®¸å‡çº§åˆ°ç ´åæ€§ç‰ˆæœ¬ï¼ˆmajor changeï¼‰
cargo upgrade tokio@1.37.0          # å‡çº§ tokio åˆ°æŒ‡å®šç‰ˆæœ¬
```

> å®ƒä¼šæ ¹æ® crates.io çš„æœ€æ–°ç‰ˆæœ¬ä¿®æ”¹ä½ çš„ `Cargo.toml`ï¼Œå¹¶ä¿æŒ `Cargo.lock` åŒæ­¥æ›´æ–°ã€‚

---

## ğŸ”§ å…¶ä»–å¯é€‰åŠŸèƒ½

| å‘½ä»¤                                              | åŠŸèƒ½                                          | æ˜¯å¦å¸¸ç”¨  |
| ----------------------------------------------- | ------------------------------------------- | ----- |
| `cargo set-version`                             | è®¾ç½®å½“å‰ crate çš„ç‰ˆæœ¬ï¼ˆå¦‚ `cargo set-version 1.2.3`ï¼‰ | â­ ä¸­ç­‰  |
| `cargo upgrade --precise 1.3.0`                 | ç²¾ç¡®åœ°å‡çº§åˆ°æŸç‰ˆæœ¬ï¼ˆé¿å…èŒƒå›´æ¨æ–­ï¼‰                           | â­â­ å¸¸ç”¨ |
| `cargo add foo --optional`                      | æ·»åŠ ä¸ºå¯é€‰ä¾èµ–ï¼ˆå¯é…åˆ feature ä½¿ç”¨ï¼‰                     | â­â­ æ¨è |
| `cargo add foo --target wasm32-unknown-unknown` | ä¸ºç‰¹å®šç›®æ ‡å¹³å°æ·»åŠ ä¾èµ–                                 | ğŸ”§ é«˜çº§ |

---

## ğŸ§© å®ç”¨ç»„åˆï¼šé…åˆ Feature ä½¿ç”¨

```bash
cargo add serde --features derive --optional
```

ç­‰ä»·äºï¼š

```toml
[dependencies]
serde = { version = "1.0", optional = true, features = ["derive"] }
```

è¿™åœ¨æ„å»ºæ¨¡å—åŒ–æˆ–æ’ä»¶å¼æ¶æ„æ—¶éå¸¸æœ‰ç”¨ã€‚

---

## ğŸ§ª ç‰ˆæœ¬è¯´æ˜ä¸ç¨³å®šæ€§

-   `cargo-edit 1.0+` ç‰ˆæœ¬å·²ç»éå¸¸ç¨³å®šï¼Œæ¨èåœ¨æ‰€æœ‰ Rust å·¥ç¨‹ä¸­å®‰è£…ã€‚
    
-   å®ƒä½¿ç”¨ç¨³å®šçš„ Rust ç¼–è¯‘ï¼Œæ— éœ€ nightlyã€‚
    
-   å·²è¢«è®¸å¤š IDE ä¸å·¥å…·é“¾é›†æˆï¼ˆå¦‚ VSCode æ’ä»¶ã€JetBrains Rust ç­‰ï¼‰ã€‚
    

---

## æ€»ç»“

| å‘½ä»¤ | ä½œç”¨ | ç­‰ä»·äºæ‰‹åŠ¨ |
| --- | --- | --- |
| `cargo add serde` | æ·»åŠ ä¾èµ– | ä¿®æ”¹ `Cargo.toml` æ‰‹åŠ¨å†™å…¥ä¾èµ–é¡¹ |
| `cargo rm serde` | åˆ é™¤ä¾èµ– | æ‰‹åŠ¨åˆ é™¤ `Cargo.toml` ä¸­çš„æ¡ç›® |
| `cargo upgrade` | å‡çº§ä¾èµ– | æ‰‹åŠ¨æŸ¥ç‰ˆæœ¬ + ä¿®æ”¹ + `cargo update` |

---