# 驯服不确定性的方法

## 方法一：将不确定性封装在安全的 API 中

核心思路是**屏蔽底层不必要的不确定性**，同时**暴露高层可控的不确定性**，降低普通开发者的使用门槛：

- **隐藏底层不确定性**：屏蔽并发执行中低层级、难以理解的不确定性（例如指令级别的交错执行），避免开发者直接面对硬件 / 编译器优化、线程调度顺序等复杂细节。
- **暴露高层不确定性**：仅对外开放符合业务逻辑的高层不确定性（例如并发队列的操作交错 —— 如多个线程同时入队 / 出队的顺序），这类不确定性通常是业务可接受或可预测的。
- **核心优势**：大多数开发者无需理解并发机制的底层实现，只需掌握安全 API 的使用规则即可正确编写并发程序。
- **典型示例**：锁（Locks）、条件变量（Conditional Variables）、并发数据结构（如线程安全的队列、哈希表）等组件的安全 API—— 开发者只需调用 “加锁”“解锁”“入队”“出队” 等接口，无需关心锁的底层实现（如如何禁用指令重排序、如何实现线程阻塞与唤醒）。

## 方法二：在实现中采用经过验证的同步模式进行推理

对于需要开发并发基础组件（如锁、条件变量、并发数据结构）的底层开发者，需遵循严谨的设计原则：

  

- **适用场景**：当开发者需要实现锁、条件变量、线程安全数据结构等并发基础组件时，必须直面底层不确定性，此时需依赖可靠的设计方法。
- **核心原则**：仅使用**经过充分研究和验证的同步模式**（如信号量机制、管程模型、CAS（Compare-and-Swap）操作模式等），避免自行设计未经验证的同步逻辑 —— 这类成熟模式已被证明能有效规避数据竞争、死锁等问题。

## 本课程定位：学习并发库的 API 与实现

（课程将围绕两方面展开：一方面帮助学习者掌握并发库安全 API 的使用方法，能基于 API 编写正确的并发程序；另一方面深入并发库的底层实现逻辑，理解锁、条件变量、并发数据结构等组件如何通过同步模式驯服不确定性，兼顾 “会用” 与 “懂原理”。）

### 关键术语补充

- **API（Application Programming Interface，应用程序编程接口）**：并发库对外提供的操作接口，是开发者与底层并发机制之间的 “桥梁”，封装了复杂实现，提供安全的使用方式。
- **Synchronization Patterns（同步模式）**：在并发编程中经过实践验证、可重复使用的设计方案，用于协调多个线程的执行顺序、保证共享资源的安全访问（如 “加锁 - 访问 - 解锁” 模式、“生产者 - 消费者” 模式）。
- **Concurrency Libraries（并发库）**：提供并发编程所需基础组件的库（如 C++ 的`<thread>``<mutex>`库、Java 的`java.util.concurrent`包），包含安全 API 及底层实现，是驯服并发不确定性的核心工具。